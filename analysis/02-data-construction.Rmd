# Data Construction

**Multiple Imputation & Survey Weights**
Several variables have a substantial amount of missing data. I used the Amelia package to create five imputation datasets that will be combined for the final results. I then set up the survey dseign using the list of imputed datasets to account for the complex survey design.

```{r weights}
vars <- c('satisfied', 'extremely_satisfied', 'better',  'much_better',
          'dem.race', 'agec', 'forbornc', 'manc', 'kidsc', 'marriedc',
          'educ1c', 'educ2c', 'educ3c', 'educ5c', 'inc1c',
          'inc3c', 'inc4c', 'nhdyrsc', 'nhdsize1c', 'nhdsize3c', 'quadc',
          'consider_num', 'consider_any', 'notconsider_num', 'notconsider_any',
          unlist(new_search_names))
idvars <- c('studycase','weight', 'sample_strata')
dcassub <- dcas[!is.na(dcas$dem.race), c(vars, idvars)]
nominals <- vars[!(vars %in% c('agec', 'nhdyrsc', 
                               'consider_num', 'notconsider_num'))]
set.seed(214518)
dcasmi <- amelia(dcassub, m=5, noms=nominals, emburn = c (500 , 500) , 
                 p2s = F, idvars=idvars)
dcassvy <- svydesign(id=~1,strata=~sample_strata,weights=~weight,data=imputationList(dcasmi$imputations))

save(vars, dcassvy, dcas, dataDIR, file = '../data/dcassvy.Rdata')
```

# Analysis
## Analytical Approach
For each analysis, run three models. The first includes only race; the second adds demographic characteristics; and the third adds the resident's experience with the neighborhood. Source `R` files used to report analysis to tables.

```{r setup-analysis-environment}
rm(list=ls())
load('../data/dcassvy.Rdata')
m1 <- 'dem.race'
m2 <- paste0(m1, '+ agec + forbornc + manc + kidsc + marriedc + ',
'educ1c + educ2c + educ3c + educ5c + inc1c + inc3c + inc4c')
m3 <- paste0(m2, '+ nhdyrsc + nhdsize1c + nhdsize3c + quadc')
source('broom_mi.R') ## Saves multiple imputation
                     ## objects for use with tidyverse
source('report_models.R')
```


